<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>云随笔</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-03-08T09:19:43.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>自由的浮云</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>WKWebView中OC与JS交互二-OC向JS传递信息</title>
    <link href="http://yoursite.com/2017/03/08/WKWebView%E4%B8%ADOC%E4%B8%8EJS%E4%BA%A4%E4%BA%92%E4%BA%8C-OC%E5%90%91JS%E4%BC%A0%E9%80%92%E4%BF%A1%E6%81%AF/"/>
    <id>http://yoursite.com/2017/03/08/WKWebView中OC与JS交互二-OC向JS传递信息/</id>
    <published>2017-03-08T09:16:52.000Z</published>
    <updated>2017-03-08T09:19:43.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="&#x80CC;&#x666F;"><a href="#&#x80CC;&#x666F;" class="headerlink" title="&#x80CC;&#x666F;"></a>&#x80CC;&#x666F;</h2><p>&#x5728;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x9047;&#x5230;&#x4E86;&#x9700;&#x8981;OC&#x4E0E;JS&#x4EA4;&#x6362;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x9879;&#x76EE;&#x4E2D;&#x7684;webView&#x4E0D;&#x662F;&#x4F20;&#x7EDF;&#x7684;<a href="https://developer.apple.com/reference/uikit/uiwebview" target="_blank" rel="external">UIWebView</a>&#xFF0C;&#x800C;&#x8981;&#x662F;iOS 8&#x4EE5;&#x540E;&#x51FA;&#x73B0;&#x7684;<a href="https://developer.apple.com/reference/webkit/wkwebview" target="_blank" rel="external">WKWebView</a>&#xFF0C;WKWebView&#x7684;&#x4F7F;&#x7528;&#x4E0E;UIWebView&#x7684;&#x4F7F;&#x7528;&#x7565;&#x6709;&#x4E0D;&#x540C;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x5728;&#x6B64;&#x7B80;&#x5355;&#x8BB0;&#x5F55;&#xFF0C;&#x5982;&#x4F55;&#x5728;WKWebView&#x4E2D;&#xFF0C;OC&#x5411;JS&#x4F20;&#x9012;&#x6D88;&#x606F;&#xFF0C;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x5982;&#x4F55;&#x70B9;&#x51FB;&#x539F;&#x751F;&#x9875;&#x9762;&#x7684;&#x6309;&#x94AE;&#xFF0C;&#x5411;js&#x4F20;&#x9012;&#x6D88;&#x606F;</p>
<a id="more"></a>
<h2 id="&#x5177;&#x4F53;&#x6B65;&#x9AA4;"><a href="#&#x5177;&#x4F53;&#x6B65;&#x9AA4;" class="headerlink" title="&#x5177;&#x4F53;&#x6B65;&#x9AA4;"></a>&#x5177;&#x4F53;&#x6B65;&#x9AA4;</h2><h3 id="&#x672C;&#x4E91;&#x7684;&#x672C;&#x5730;html-test-html-&#x5982;&#x4E0B;"><a href="#&#x672C;&#x4E91;&#x7684;&#x672C;&#x5730;html-test-html-&#x5982;&#x4E0B;" class="headerlink" title="&#x672C;&#x4E91;&#x7684;&#x672C;&#x5730;html(test.html)&#x5982;&#x4E0B;"></a>&#x672C;&#x4E91;&#x7684;&#x672C;&#x5730;html(test.html)&#x5982;&#x4E0B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">   &lt;script type =&quot;text/javascript&quot; &gt;</div><div class="line">    function getNativeMsg(src)</div><div class="line">    {</div><div class="line">       document.getElementById(&quot;Mytr&quot;).value=src;</div><div class="line">    }</div><div class="line">    </div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    </div><div class="line">&lt;textarea id =&quot;Mytr&quot; type=&quot;value&quot; style=&quot;width:100%;height:400px;left:0px;top:0px&quot;&gt;&#x6D4B;&#x8BD5;&lt;/textarea&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>&#x5728;test.html&#x4E2D;&#xFF0C;&#x672C;&#x4E91;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x6587;&#x672C;&#x663E;&#x793A;&#x533A;(textarea)&#x6765;&#x663E;&#x793A;&#x4FE1;&#x606F;(&#x9ED8;&#x8BA4;&#x4E3A;&#x201D;&#x6D4B;&#x8BD5;&#x201D;)&#xFF0C;&#x7136;&#x540E;&#x5728;js&#x91CC;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x51FD;&#x6570;<code>getNativeMsg</code>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5229;&#x7528;<code>document.getElementById</code>&#x5F97;&#x5230;&#x6587;&#x672C;&#x663E;&#x793A;&#x533A;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x51FD;&#x6570;&#x4F20;&#x7684;&#x503C;&#xFF0C;&#x6765;&#x6539;&#x53D8;&#x6587;&#x672C;&#x533A;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x662F;&#x901A;&#x8FC7;OC&#x4F20;&#x9012;&#x7684;&#x3002;</p>
<h3 id="&#x672C;&#x4E91;&#x7684;iOS&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5982;&#x4E0B;"><a href="#&#x672C;&#x4E91;&#x7684;iOS&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5982;&#x4E0B;" class="headerlink" title="&#x672C;&#x4E91;&#x7684;iOS&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5982;&#x4E0B;"></a>&#x672C;&#x4E91;&#x7684;iOS&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</h3><p>&#x5728;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x5BFC;&#x5165;WebKit.framework&#xFF0C;&#x5728;&#x9700;&#x8981;&#x5C55;&#x793A;web&#x9875;&#x7684;.m&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5F15;&#x5165;&#x5934;&#x6587;&#x4EF6;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#import &lt;WebKit/WebKit.h&gt;</div></pre></td></tr></table></figure>
<p>&#x5728;viewDidLoad&#x65B9;&#x6CD5;&#x91CC;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">//&#x51C6;&#x5907;&#x6D4F;&#x89C8;&#x5668;</div><div class="line">    self.webView=({</div><div class="line">        //JS&#x4EA4;&#x4E92;&#x76F8;&#x5173;&#x7684;&#x914D;&#x7F6E;</div><div class="line">        WKWebViewConfiguration *config=[[WKWebViewConfiguration alloc]init];</div><div class="line">        //&#x5141;&#x8BB8;&#x6267;&#x884C;js</div><div class="line">        config.preferences=[[WKPreferences alloc]init];</div><div class="line">        config.preferences.javaScriptEnabled=YES;</div><div class="line">        //&#x8BBE;&#x7F6E;userController</div><div class="line">        WKUserContentController *controller=[[WKUserContentController alloc]init];</div><div class="line">        config.userContentController=controller;</div><div class="line">        WKWebView *webView=[[WKWebView alloc]initWithFrame:CGRectMake(0, 20, [UIScreen mainScreen].bounds.size.width, [UIScreen mainScreen].bounds.size.height/2) configuration:config];</div><div class="line">        webView;</div><div class="line">        </div><div class="line">    });</div><div class="line">    [self.view addSubview:self.webView];</div><div class="line">    //&#x52A0;&#x8F7D;&#x9875;&#x9762;</div><div class="line">    NSString *filePath=[[NSBundle mainBundle]pathForResource:@&quot;test&quot; ofType:@&quot;html&quot;];</div><div class="line">    NSString *htmlString=[NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil];</div><div class="line">    [self.webView loadHTMLString:htmlString baseURL:nil];</div><div class="line">    //&#x51C6;&#x5907;&#x6309;&#x94AE;</div><div class="line">    UIButton *btn=[UIButton buttonWithType:UIButtonTypeSystem];</div><div class="line">    btn.frame=CGRectMake(0, [UIScreen mainScreen].bounds.size.height/2+50, [UIScreen mainScreen].bounds.size.width, 30);</div><div class="line">    [btn setTitle:@&quot;&#x5F00;&#x59CB;&#x53D1;&#x6D88;&#x606F;&quot; forState:UIControlStateNormal];</div><div class="line">    [btn addTarget:self action:@selector(btnClicked) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    [self.view addSubview:btn];</div></pre></td></tr></table></figure>
<p>&#x5728;&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x9996;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<a href="https://developer.apple.com/reference/webkit/wkwebviewconfiguration" target="_blank" rel="external">WKWebViewConfiguration</a>&#xFF0C;&#x7528;&#x6765;&#x8BBE;&#x7F6E;webView&#x76F8;&#x5173;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x521B;&#x5EFA;<a href="https://developer.apple.com/reference/webkit/wkusercontentcontroller" target="_blank" rel="external">WKUserContentController</a>&#x6765;&#x5904;&#x7406;OC&#x4E0E;JS&#x4EA4;&#x4E92;&#xFF0C;&#x518D;&#x7136;&#x540E;&#xFF0C;&#x83B7;&#x53D6;&#x672C;&#x5730;HTML&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x7528;WebView&#x52A0;&#x8F7D;</p>
<p>&#x6309;&#x94AE;&#x7684;&#x54CD;&#x5E94;&#x4E8B;&#x4EF6;&#x5982;&#x4E0B;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-(void)btnClicked</div><div class="line">{</div><div class="line">    [self.webView evaluateJavaScript:@&quot;getNativeMsg(\&apos;&#x4F60;&#x597D;&#xFF0C;&#x81EA;&#x7531;&#x7684;&#x6D6E;&#x4E91;\&apos;)&quot; completionHandler:^(id _Nullable msg, NSError * _Nullable error) {</div><div class="line">    }];</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x5728;&#x6309;&#x94AE;&#x54CD;&#x5E94;&#x4E8B;&#x4EF6;&#x4E2D;&#xFF0C;&#x901A;&#x8FC7;<code>evaluateJavaScript: completionHandler:^(id _Nullable msg, NSError * _Nullable error)</code>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x6267;&#x884C;js&#xFF0C;&#x8FBE;&#x5230;OC&#x5411;JS&#x4F20;&#x9012;&#x6D88;&#x606F;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x5176;&#x4E2D;&#xFF0C;<code>getNativeMsg</code>&#x662F;JS&#x4E2D;&#x5BF9;&#x5E94;&#x7684;&#x51FD;&#x6570;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x540E;&#x9762;&#x5219;&#x662F;&#x4F20;&#x9012;&#x7684;&#x6D88;&#x606F;,&#x6700;&#x7EC8;&#x6548;&#x679C;&#x5982;&#x56FE;</p>
<p><img src="/2017/03/08/WKWebView&#x4E2D;OC&#x4E0E;JS&#x4EA4;&#x4E92;&#x4E8C;-OC&#x5411;JS&#x4F20;&#x9012;&#x4FE1;&#x606F;/OCtojs1.gif" alt=""></p>
<p>&#x53E6;&#x5916;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;<code>WKUIDelegate</code>&#x4E2D;&#x7684;<code>- (void)webView:(WKWebView *)webView runJavaScriptAlertPanelWithMessage:(NSString *)message initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(void))completionHandler</code>&#x3001;<code>- (void)webView:(WKWebView *)webView runJavaScriptConfirmPanelWithMessage:(NSString *)message initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(BOOL result))completionHandler</code>&#x548C;<code>- (void)webView:(WKWebView *)webView runJavaScriptTextInputPanelWithPrompt:(NSString *)prompt defaultText:(nullable NSString *)defaultText initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(NSString * _Nullable result))completionHandler</code>&#x6765;&#x62E6;&#x622A;HTML&#x7684;alert</p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x672C;&#x4E91;&#x5728;&#x6B64;&#x7B80;&#x5355;&#x5730;&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x7528;WKWebView&#x52A0;&#x8F7D;&#x672C;&#x5730;HTML&#xFF0C;&#x4EE5;&#x53CA;&#x7B80;&#x5355;&#x7684;js&#x4E0E;OC&#x4EA4;&#x4E92;&#xFF0C;&#x7531;&#x4E8E;&#x672C;&#x4E91;&#x80FD;&#x529B;&#x6709;&#x9650;&#xFF0C;&#x4E0A;&#x8FF0;&#x5185;&#x5BB9;&#x96BE;&#x514D;&#x4F1A;&#x6709;&#x8C2C;&#x8BEF;&#xFF0C;&#x5FD8;&#x5404;&#x4F4D;&#x5927;&#x795E;&#x4E0D;&#x541D;&#x8D50;&#x6559;&#xFF0C;&#x6B22;&#x8FCE;&#x5404;&#x4F4D;&#x6765;&#x7838;&#x573A;&#x5B50;&#xFF0C;&#x672C;&#x4E91;&#x4E0D;&#x80DC;&#x611F;&#x6FC0;</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;&amp;#x80CC;&amp;#x666F;&quot;&gt;&lt;a href=&quot;#&amp;#x80CC;&amp;#x666F;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x80CC;&amp;#x666F;&quot;&gt;&lt;/a&gt;&amp;#x80CC;&amp;#x666F;&lt;/h2&gt;&lt;p&gt;&amp;#x5728;&amp;#x9879;&amp;#x76EE;&amp;#x4E2D;&amp;#xFF0C;&amp;#x9047;&amp;#x5230;&amp;#x4E86;&amp;#x9700;&amp;#x8981;OC&amp;#x4E0E;JS&amp;#x4EA4;&amp;#x6362;&amp;#x7684;&amp;#x573A;&amp;#x666F;&amp;#xFF0C;&amp;#x9879;&amp;#x76EE;&amp;#x4E2D;&amp;#x7684;webView&amp;#x4E0D;&amp;#x662F;&amp;#x4F20;&amp;#x7EDF;&amp;#x7684;&lt;a href=&quot;https://developer.apple.com/reference/uikit/uiwebview&quot;&gt;UIWebView&lt;/a&gt;&amp;#xFF0C;&amp;#x800C;&amp;#x8981;&amp;#x662F;iOS 8&amp;#x4EE5;&amp;#x540E;&amp;#x51FA;&amp;#x73B0;&amp;#x7684;&lt;a href=&quot;https://developer.apple.com/reference/webkit/wkwebview&quot;&gt;WKWebView&lt;/a&gt;&amp;#xFF0C;WKWebView&amp;#x7684;&amp;#x4F7F;&amp;#x7528;&amp;#x4E0E;UIWebView&amp;#x7684;&amp;#x4F7F;&amp;#x7528;&amp;#x7565;&amp;#x6709;&amp;#x4E0D;&amp;#x540C;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#xFF0C;&amp;#x672C;&amp;#x4E91;&amp;#x5728;&amp;#x6B64;&amp;#x7B80;&amp;#x5355;&amp;#x8BB0;&amp;#x5F55;&amp;#xFF0C;&amp;#x5982;&amp;#x4F55;&amp;#x5728;WKWebView&amp;#x4E2D;&amp;#xFF0C;OC&amp;#x5411;JS&amp;#x4F20;&amp;#x9012;&amp;#x6D88;&amp;#x606F;&amp;#xFF0C;&amp;#x7B80;&amp;#x5355;&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x5982;&amp;#x4F55;&amp;#x70B9;&amp;#x51FB;&amp;#x539F;&amp;#x751F;&amp;#x9875;&amp;#x9762;&amp;#x7684;&amp;#x6309;&amp;#x94AE;&amp;#xFF0C;&amp;#x5411;js&amp;#x4F20;&amp;#x9012;&amp;#x6D88;&amp;#x606F;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>WKWebView中OC与JS交互一-JS向OC传递信息</title>
    <link href="http://yoursite.com/2017/01/18/WKWebView%E4%B8%ADOC%E4%B8%8EJS%E4%BA%A4%E4%BA%92%E4%B8%80-JS%E5%90%91OC%E4%BC%A0%E9%80%92%E4%BF%A1%E6%81%AF/"/>
    <id>http://yoursite.com/2017/01/18/WKWebView中OC与JS交互一-JS向OC传递信息/</id>
    <published>2017-01-18T09:13:59.000Z</published>
    <updated>2017-01-18T09:14:30.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="&#x80CC;&#x666F;"><a href="#&#x80CC;&#x666F;" class="headerlink" title="&#x80CC;&#x666F;"></a>&#x80CC;&#x666F;</h2><p>&#x5728;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x9047;&#x5230;&#x4E86;&#x9700;&#x8981;js&#x4E0E;OC&#x4EA4;&#x6362;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x8BE6;&#x60C5;&#x9875;&#x662F;&#x5BCC;&#x6587;&#x672C;&#x5C55;&#x793A;&#x7684;&#x56FE;&#x6587;&#x6DF7;&#x6392;&#x6837;&#x5F0F;&#xFF0C;&#x5982;&#x679C;&#x901A;&#x8FC7;HTML&#x6765;&#x5C55;&#x793A;&#xFF0C;&#x90A3;&#x4E48;&#x9700;&#x8981;&#x56FE;&#x7247;&#x80FD;&#x70B9;&#x51FB;&#xFF0C;&#x5E76;&#x4E14;&#x8C03;&#x7528;&#x56FE;&#x7247;&#x67E5;&#x770B;&#x5668;&#x7B49;&#x529F;&#x80FD;&#xFF0C;&#x8FD9;&#x91CC;&#xFF0C;&#x5C31;&#x6D89;&#x53CA;&#x5230;&#x4E86;OC&#x4E0E;JS&#x4EA4;&#x4E92;&#x3002;&#x7531;&#x4E8E;&#x9879;&#x76EE;&#x8981;&#x652F;&#x6301;iOS 10&#xFF0C;&#x5E76;&#x4E14;&#x56FE;&#x7247;&#x7684;&#x5730;&#x5740;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x90FD;&#x662F;HTTPS&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x672C;&#x5730;&#x7684;webView&#x80FD;&#x52A0;&#x8F7D;http&#x94FE;&#x63A5;&#x5E76;&#x901A;&#x8FC7;ATS&#x9A8C;&#x8BC1;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x9879;&#x76EE;&#x4E2D;&#x7684;webView&#x5C31;&#x4E0D;&#x80FD;&#x7528;&#x4F20;&#x7EDF;&#x7684;<a href="https://developer.apple.com/reference/uikit/uiwebview" target="_blank" rel="external">UIWebView</a>&#xFF0C;&#x800C;&#x8981;&#x7528;iOS 8&#x4EE5;&#x540E;&#x51FA;&#x73B0;&#x7684;<a href="https://developer.apple.com/reference/webkit/wkwebview" target="_blank" rel="external">WKWebView</a>&#xFF0C;WKWebView&#x7684;&#x4F7F;&#x7528;&#x4E0E;UIWebView&#x7684;&#x4F7F;&#x7528;&#x7565;&#x6709;&#x4E0D;&#x540C;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x5728;&#x6B64;&#x7B80;&#x5355;&#x8BB0;&#x5F55;&#xFF0C;&#x5982;&#x4F55;&#x5728;WKWebView&#x4E2D;&#xFF0C;JS&#x5411;OC&#x4F20;&#x9012;&#x6D88;&#x606F;&#xFF0C;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x5982;&#x4F55;&#x70B9;&#x51FB;HTML&#x91CC;&#x9762;&#x7684;&#x56FE;&#x7247;&#xFF0C;OC&#x7AEF;&#x5F97;&#x5230;&#x56FE;&#x7247;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;.</p>
<a id="more"></a>
<h2 id="&#x5177;&#x4F53;&#x6B65;&#x9AA4;"><a href="#&#x5177;&#x4F53;&#x6B65;&#x9AA4;" class="headerlink" title="&#x5177;&#x4F53;&#x6B65;&#x9AA4;"></a>&#x5177;&#x4F53;&#x6B65;&#x9AA4;</h2><h3 id="&#x672C;&#x4E91;&#x7684;html&#x6A21;&#x677F;-temp-html-&#x5982;&#x4E0B;"><a href="#&#x672C;&#x4E91;&#x7684;html&#x6A21;&#x677F;-temp-html-&#x5982;&#x4E0B;" class="headerlink" title="&#x672C;&#x4E91;&#x7684;html&#x6A21;&#x677F;(temp.html)&#x5982;&#x4E0B;"></a>&#x672C;&#x4E91;&#x7684;html&#x6A21;&#x677F;(temp.html)&#x5982;&#x4E0B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">      &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width-20, initial-scale=1.0, maximum-scale=1.0, user-scalable=0&quot;&gt;</div><div class="line">      &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</div><div class="line">          &lt;style&gt;</div><div class="line">                p img {</div><div class="line">                  text-indent: 0;</div><div class="line">                        }</div><div class="line">          </div><div class="line">                img {</div><div class="line">                    max-width: 100% !important;</div><div class="line">                    height: auto !important;</div><div class="line">                    }</div><div class="line">        &lt;/style&gt;</div><div class="line">         &lt;script type=&apos;text/javascript&apos;&gt;</div><div class="line">           function clickedImg(src)</div><div class="line">			{</div><div class="line">                                    window.webkit.messageHandlers.imgOnClick.postMessage({ src});</div><div class="line">			}</div><div class="line">        &lt;/script&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">     </div><div class="line">     &lt;div class=&apos;text-content&apos;&gt;</div><div class="line">         {{body_placeholder}}</div><div class="line">     &lt;/div&gt;</div><div class="line">     </div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>&#x5728;temp.html&#x4E2D;&#xFF0C;&#x672C;&#x4E91;&#x9996;&#x5148;&#x8BBE;&#x7F6E;&#x4E86;&#x9875;&#x9762;&#x7684;&#x6837;&#x5F0F;&#xFF0C;&#x7136;&#x540E;&#x5728;body&#x4E2D;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;div&#xFF0C;div&#x91CC;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x7AD9;&#x4F4D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x540E;&#x7EED;&#x6240;&#x6709;&#x7684;html&#x8BED;&#x8A00;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B57;&#x7B26;&#x4E32;&#x66FF;&#x6362;&#x7684;&#x65B9;&#x5F0F;&#x52A0;&#x5165;&#x5230;&#x8FD9;&#x4E2A;div&#x4E2D;&#xFF0C;&#x540C;&#x65F6;&#xFF0C;&#x672C;&#x4E91;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;js&#x51FD;&#x6570; clickedImg(src)&#xFF0C;&#x70B9;&#x51FB;&#x56FE;&#x7247;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x901A;&#x8FC7;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">window.webkit.messageHandlers.imgOnClick.postMessage({src});</div></pre></td></tr></table></figure>
<p> &#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x6765;&#x5411;OC&#x4F20;&#x9012;&#x4FE1;&#x606F;&#xFF0C;&#x5176;&#x4E2D;&#xFF0C;imgOnClick&#x662F;&#x672C;&#x4E91;&#x968F;&#x4FBF;&#x547D;&#x540D;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x540D;&#x79F0;&#x4F1A;&#x5728;WKWebView&#x91CC;&#x6CE8;&#x518C; &#xFF0C;postMessage &#x91CC;&#x9762;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5C31;&#x662F;js&#x5411;OC&#x4F20;&#x9012;&#x7684;&#x5185;&#x5BB9;</p>
<h3 id="&#x672C;&#x4E91;&#x7684;html&#x6587;&#x4EF6;-news-html-&#x4EE3;&#x7801;&#x5982;&#x4E0B;"><a href="#&#x672C;&#x4E91;&#x7684;html&#x6587;&#x4EF6;-news-html-&#x4EE3;&#x7801;&#x5982;&#x4E0B;" class="headerlink" title="&#x672C;&#x4E91;&#x7684;html&#x6587;&#x4EF6;(news.html)&#x4EE3;&#x7801;&#x5982;&#x4E0B;"></a>&#x672C;&#x4E91;&#x7684;html&#x6587;&#x4EF6;(news.html)&#x4EE3;&#x7801;&#x5982;&#x4E0B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;1</div><div class="line"></div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;1&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;1&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line"></div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;2</div><div class="line"></div><div class="line">&lt;img src=&quot;&#x56FE;&#x7247;2&#x7684;&#x5730;&#x5740;&quot; style=&quot;width:100%%&quot; onclick=clickedImg(&apos;&#x56FE;&#x7247;2&#x7684;&#x5730;&#x5740;&apos;) / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;3</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;3&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;3&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;4</div><div class="line"></div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;4&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;4&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;5</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;5&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;5&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;6</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;6&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;6&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;7</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;7&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;7&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;8</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;8&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;8&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;9</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;9&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;9&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;10</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;10&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;10&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;11</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;11&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;11&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;p style=&quot;color: rgb(54, 54, 54); font-size: 18px; line-height: 1.6em; word-wrap: break-word;&quot;&gt;&#x672C;&#x4E91;&#x7684;&#x6D4B;&#x8BD5;&#x56FE;&#x7247;12</div><div class="line"></div><div class="line">&lt;img src=&apos;&#x56FE;&#x7247;12&#x7684;&#x5730;&#x5740;&apos; style=&apos;width:100%%&apos; onclick =clickedImg(&apos;&#x56FE;&#x7247;12&#x7684;&#x5730;&#x5740;&apos;)  / &gt;</div><div class="line">&lt;/p&gt;</div></pre></td></tr></table></figure>
<h3 id="&#x672C;&#x4E91;&#x7684;iOS&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5982;&#x4E0B;"><a href="#&#x672C;&#x4E91;&#x7684;iOS&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5982;&#x4E0B;" class="headerlink" title="&#x672C;&#x4E91;&#x7684;iOS&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5982;&#x4E0B;"></a>&#x672C;&#x4E91;&#x7684;iOS&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</h3><p>&#x5728;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x5BFC;&#x5165;WebKit.framework&#xFF0C;&#x5728;&#x9700;&#x8981;&#x5C55;&#x793A;web&#x9875;&#x7684;.m&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5F15;&#x5165;&#x5934;&#x6587;&#x4EF6;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#import &lt;WebKit/WebKit.h&gt;</div></pre></td></tr></table></figure>
<p>&#x5E76;&#x9075;&#x5B88;&#x534F;&#x8BAE;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;WKNavigationDelegate,WKScriptMessageHandler&gt;</div></pre></td></tr></table></figure>
<p>&#x5728;viewDidLoad&#x65B9;&#x6CD5;&#x91CC;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">self.view.backgroundColor=[UIColor whiteColor];</div><div class="line">    WKWebView *web=({</div><div class="line">        </div><div class="line">        WKWebViewConfiguration *config = [[WKWebViewConfiguration alloc] init];</div><div class="line">        config.preferences = [[WKPreferences alloc] init];</div><div class="line">        config.preferences.javaScriptEnabled = YES;</div><div class="line">        config.preferences.javaScriptCanOpenWindowsAutomatically = YES;</div><div class="line">        </div><div class="line">        WKUserContentController *userController = [[WKUserContentController alloc] init];</div><div class="line">        config.userContentController=userController;</div><div class="line">        //&#x6DFB;&#x52A0;js&#x4E0E;OC&#x4EA4;&#x4E92;&#x7684;&#x56DE;&#x8C03;</div><div class="line">        [userController addScriptMessageHandler:self name:@&quot;imgOnClick&quot;];</div><div class="line">        </div><div class="line">        WKWebView *web=[[WKWebView alloc]initWithFrame:CGRectMake(0, 20, [UIScreen mainScreen].bounds.size.width, [UIScreen mainScreen].bounds.size.height-20) configuration:config];</div><div class="line">        web.navigationDelegate=self;</div><div class="line">        //webView&#x6DFB;&#x52A0;&#x5230;&#x89C6;&#x56FE;&#x4E0A;</div><div class="line">        [self.view addSubview:web];</div><div class="line">        </div><div class="line">        //&#x83B7;&#x5F97;&#x672C;&#x5730;html&#x5B57;&#x7B26;&#x4E32;</div><div class="line">        NSString *htmlBodyStringPath=[[NSBundle mainBundle]pathForResource:@&quot;news&quot; ofType:@&quot;html&quot;];</div><div class="line">        NSString *htmlBodyString =[NSString stringWithContentsOfFile:htmlBodyStringPath encoding:NSUTF8StringEncoding error:nil];</div><div class="line">        </div><div class="line">        //&#x83B7;&#x5F97;&#x672C;&#x5730;html&#x6A21;&#x677F;</div><div class="line">        NSString *tempPath = [[NSBundle mainBundle]pathForResource:@&quot;temp&quot; ofType:@&quot;html&quot;];</div><div class="line">        //&#x52A0;&#x8F7D;temp&#x5185;&#x5BB9;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;</div><div class="line">        NSString *tempHtml = [NSString stringWithContentsOfFile:tempPath encoding:NSUTF8StringEncoding error:nil];</div><div class="line">        </div><div class="line">        //&#x66FF;&#x6362;temp&#x5185;&#x7684;&#x5360;&#x4F4D;&#x7B26;{{body_placeholder}}&#x4E3A;&#x9700;&#x8981;&#x52A0;&#x8F7D;&#x7684;HTML&#x4EE3;&#x7801;</div><div class="line">        tempHtml = [tempHtml stringByReplacingOccurrencesOfString:@&quot;{{body_placeholder}}&quot; withString:htmlBodyString];</div><div class="line">        //&#x52A0;&#x8F7D;HTMLString</div><div class="line">        [web loadHTMLString:tempHtml baseURL:nil];</div><div class="line">        </div><div class="line">        web;</div><div class="line">    });</div></pre></td></tr></table></figure>
<p>&#x5728;&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x9996;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<a href="https://developer.apple.com/reference/webkit/wkwebviewconfiguration" target="_blank" rel="external">WKWebViewConfiguration</a>&#xFF0C;&#x7528;&#x6765;&#x8BBE;&#x7F6E;webView&#x76F8;&#x5173;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x521B;&#x5EFA;<a href="https://developer.apple.com/reference/webkit/wkusercontentcontroller" target="_blank" rel="external">WKUserContentController</a>&#x6765;&#x5904;&#x7406;OC&#x4E0E;JS&#x4EA4;&#x4E92;&#xFF0C;&#x518D;&#x7136;&#x540E;&#xFF0C;&#x83B7;&#x53D6;&#x672C;&#x5730;HTML&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x7528;WebView&#x52A0;&#x8F7D;&#xFF0C;&#x5728;&#x4E0A;&#x8FF0;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[userController addScriptMessageHandler:self name:@&quot;imgOnClick&quot;];</div></pre></td></tr></table></figure>
<p>&#x91CC;&#x9762;&#x7684;imgOnClick&#x6B63;&#x662F;temp.html&#x91CC;&#x5199;&#x7684;js&#x4E2D;&#x8981;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">window.webkit.messageHandlers.imgOnClick.postMessage({ src});</div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#xFF0C;&#x8C03;&#x7528;<a href="https://developer.apple.com/reference/webkit/wkscriptmessagehandler" target="_blank" rel="external">WKScriptMessageHandler</a>&#x7684;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">-(void)userContentController:(WKUserContentController *)userContentController didReceiveScriptMessage:(WKScriptMessage *)message</div><div class="line">{</div><div class="line"></div><div class="line">    NSDictionary *dic=message.body;</div><div class="line">    NSString *imgAddress=[dic objectForKey:@&quot;src&quot;];</div><div class="line">    UIAlertController *alert=[UIAlertController alertControllerWithTitle:@&quot;&#x60A8;&#x70B9;&#x51FB;&#x7684;&#x56FE;&#x7247;&#x7684;&#x5730;&#x5740;&#x4E3A;&quot; message:imgAddress preferredStyle:UIAlertControllerStyleAlert];</div><div class="line">    UIAlertAction *confirmAction=[UIAlertAction actionWithTitle:@&quot;&#x786E;&#x5B9A;&quot; style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {</div><div class="line">        </div><div class="line">    }];</div><div class="line">    UIAlertAction *cancelAction=[UIAlertAction actionWithTitle:@&quot;&#x53D6;&#x6D88;&quot; style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {</div><div class="line">        </div><div class="line">    }];</div><div class="line">    [alert addAction:confirmAction];</div><div class="line">    [alert addAction:cancelAction];</div><div class="line">    [self presentViewController:alert animated:YES completion:^{</div><div class="line">        </div><div class="line">    }];</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x5728;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x5C06;&#x88AB;&#x70B9;&#x51FB;&#x7684;&#x56FE;&#x7247;&#x7684;&#x5730;&#x5740;&#x4EE5;&#x5F39;&#x7A97;&#x7684;&#x5F62;&#x5F0F;&#x5C55;&#x793A;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x7531;&#x4E8E;&#x56FE;&#x7247;&#x662F;&#x5728;&#x672C;&#x4E91;&#x7684;&#x672C;&#x5730;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x5C06;&#x5F39;&#x7A97;&#x4E2D;&#x663E;&#x793A;&#x7684;&#x56FE;&#x7247;&#x7684;&#x5730;&#x5740;&#x6539;&#x6210;&#x4E86;localhost&#xFF0C;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x5E76;&#x672A;&#x6267;&#x884C;<a href="https://developer.apple.com/reference/webkit/wknavigationdelegate" target="_blank" rel="external">WKNavigationDelegate</a>&#x7684;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x662F;&#x7531;&#x4E8E;&#x672C;&#x4E91;&#x4E60;&#x60EF;&#x4E86;&#x8BBE;&#x7F6E;&#x8FD9;&#x4E2A;&#x4EE3;&#x7406;&#x7684;&#x7F18;&#x6545;&#xFF0C;&#x8FD9;&#x4E2A;&#x534F;&#x8BAE;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;UIWebView&#x7684;<a href="https://developer.apple.com/reference/uikit/uiwebviewdelegate" target="_blank" rel="external">UIWebViewDelegate</a>,&#x6700;&#x7EC8;&#x6548;&#x679C;&#x5982;&#x56FE;</p>
<p><img src="/2017/01/18/WKWebView&#x4E2D;OC&#x4E0E;JS&#x4EA4;&#x4E92;&#x4E00;-JS&#x5411;OC&#x4F20;&#x9012;&#x4FE1;&#x606F;/js2oc1.gif" alt=""></p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x672C;&#x4E91;&#x5728;&#x6B64;&#x7B80;&#x5355;&#x5730;&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x7528;WKWebView&#x52A0;&#x8F7D;&#x672C;&#x5730;HTML&#xFF0C;&#x4EE5;&#x53CA;&#x7B80;&#x5355;&#x7684;js&#x4E0E;OC&#x4EA4;&#x4E92;&#xFF0C;&#x5E94;&#x8BE5;&#x8BF4;&#xFF0C;&#x70B9;&#x51FB;&#x56FE;&#x7247;&#xFF0C;&#x83B7;&#x5F97;&#x56FE;&#x7247;&#x5730;&#x5740;&#x8FD9;&#x4E2A;&#x573A;&#x666F;&#x5728;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;&#x8FD8;&#x662F;&#x5F88;&#x5E38;&#x89C1;&#x7684;&#xFF0C;&#x7531;&#x4E8E;&#x672C;&#x4E91;&#x80FD;&#x529B;&#x6709;&#x9650;&#xFF0C;&#x4E0A;&#x8FF0;&#x5185;&#x5BB9;&#x96BE;&#x514D;&#x4F1A;&#x6709;&#x8C2C;&#x8BEF;&#xFF0C;&#x5FD8;&#x5404;&#x4F4D;&#x5927;&#x795E;&#x4E0D;&#x541D;&#x8D50;&#x6559;&#xFF0C;&#x6B22;&#x8FCE;&#x5404;&#x4F4D;&#x6765;&#x7838;&#x573A;&#x5B50;&#xFF0C;&#x672C;&#x4E91;&#x4E0D;&#x80DC;&#x611F;&#x6FC0;</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;&amp;#x80CC;&amp;#x666F;&quot;&gt;&lt;a href=&quot;#&amp;#x80CC;&amp;#x666F;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x80CC;&amp;#x666F;&quot;&gt;&lt;/a&gt;&amp;#x80CC;&amp;#x666F;&lt;/h2&gt;&lt;p&gt;&amp;#x5728;&amp;#x9879;&amp;#x76EE;&amp;#x4E2D;&amp;#xFF0C;&amp;#x9047;&amp;#x5230;&amp;#x4E86;&amp;#x9700;&amp;#x8981;js&amp;#x4E0E;OC&amp;#x4EA4;&amp;#x6362;&amp;#x7684;&amp;#x573A;&amp;#x666F;&amp;#xFF0C;&amp;#x4F8B;&amp;#x5982;&amp;#xFF0C;&amp;#x8BE6;&amp;#x60C5;&amp;#x9875;&amp;#x662F;&amp;#x5BCC;&amp;#x6587;&amp;#x672C;&amp;#x5C55;&amp;#x793A;&amp;#x7684;&amp;#x56FE;&amp;#x6587;&amp;#x6DF7;&amp;#x6392;&amp;#x6837;&amp;#x5F0F;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x901A;&amp;#x8FC7;HTML&amp;#x6765;&amp;#x5C55;&amp;#x793A;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x9700;&amp;#x8981;&amp;#x56FE;&amp;#x7247;&amp;#x80FD;&amp;#x70B9;&amp;#x51FB;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x8C03;&amp;#x7528;&amp;#x56FE;&amp;#x7247;&amp;#x67E5;&amp;#x770B;&amp;#x5668;&amp;#x7B49;&amp;#x529F;&amp;#x80FD;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#xFF0C;&amp;#x5C31;&amp;#x6D89;&amp;#x53CA;&amp;#x5230;&amp;#x4E86;OC&amp;#x4E0E;JS&amp;#x4EA4;&amp;#x4E92;&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x9879;&amp;#x76EE;&amp;#x8981;&amp;#x652F;&amp;#x6301;iOS 10&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x56FE;&amp;#x7247;&amp;#x7684;&amp;#x5730;&amp;#x5740;&amp;#x4E0D;&amp;#x80FD;&amp;#x4FDD;&amp;#x8BC1;&amp;#x90FD;&amp;#x662F;HTTPS&amp;#x7684;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x9700;&amp;#x8981;&amp;#x672C;&amp;#x5730;&amp;#x7684;webView&amp;#x80FD;&amp;#x52A0;&amp;#x8F7D;http&amp;#x94FE;&amp;#x63A5;&amp;#x5E76;&amp;#x901A;&amp;#x8FC7;ATS&amp;#x9A8C;&amp;#x8BC1;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#xFF0C;&amp;#x9879;&amp;#x76EE;&amp;#x4E2D;&amp;#x7684;webView&amp;#x5C31;&amp;#x4E0D;&amp;#x80FD;&amp;#x7528;&amp;#x4F20;&amp;#x7EDF;&amp;#x7684;&lt;a href=&quot;https://developer.apple.com/reference/uikit/uiwebview&quot;&gt;UIWebView&lt;/a&gt;&amp;#xFF0C;&amp;#x800C;&amp;#x8981;&amp;#x7528;iOS 8&amp;#x4EE5;&amp;#x540E;&amp;#x51FA;&amp;#x73B0;&amp;#x7684;&lt;a href=&quot;https://developer.apple.com/reference/webkit/wkwebview&quot;&gt;WKWebView&lt;/a&gt;&amp;#xFF0C;WKWebView&amp;#x7684;&amp;#x4F7F;&amp;#x7528;&amp;#x4E0E;UIWebView&amp;#x7684;&amp;#x4F7F;&amp;#x7528;&amp;#x7565;&amp;#x6709;&amp;#x4E0D;&amp;#x540C;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#xFF0C;&amp;#x672C;&amp;#x4E91;&amp;#x5728;&amp;#x6B64;&amp;#x7B80;&amp;#x5355;&amp;#x8BB0;&amp;#x5F55;&amp;#xFF0C;&amp;#x5982;&amp;#x4F55;&amp;#x5728;WKWebView&amp;#x4E2D;&amp;#xFF0C;JS&amp;#x5411;OC&amp;#x4F20;&amp;#x9012;&amp;#x6D88;&amp;#x606F;&amp;#xFF0C;&amp;#x7B80;&amp;#x5355;&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x5982;&amp;#x4F55;&amp;#x70B9;&amp;#x51FB;HTML&amp;#x91CC;&amp;#x9762;&amp;#x7684;&amp;#x56FE;&amp;#x7247;&amp;#xFF0C;OC&amp;#x7AEF;&amp;#x5F97;&amp;#x5230;&amp;#x56FE;&amp;#x7247;&amp;#x7684;&amp;#x76F8;&amp;#x5173;&amp;#x4FE1;&amp;#x606F;.&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MAC本地自签名实现https</title>
    <link href="http://yoursite.com/2017/01/12/Mac%E8%87%AA%E7%AD%BE%E5%90%8D%E5%AE%9E%E7%8E%B0%E6%9C%AC%E5%9C%B0HTTPS/"/>
    <id>http://yoursite.com/2017/01/12/Mac自签名实现本地HTTPS/</id>
    <published>2017-01-12T13:26:20.000Z</published>
    <updated>2017-01-18T09:19:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="&#x80CC;&#x666F;"><a href="#&#x80CC;&#x666F;" class="headerlink" title="&#x80CC;&#x666F;"></a>&#x80CC;&#x666F;</h2><p>  &#x82F9;&#x679C;&#x5728;2016&#x5E74;&#x7684;WWDC&#x4E0A;&#x63D0;&#x51FA;&#xFF0C;&#x622A;&#x6B62;&#x5230;2016&#x5E74;&#x5E74;&#x5E95;&#xFF0C;&#x6240;&#x6709;&#x63D0;&#x4EA4;AppStore&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x5FC5;&#x987B;&#x5F3A;&#x5236;&#x652F;&#x6301;HTTPS&#xFF08;&#x540E;&#x6765;&#x5EF6;&#x671F;&#x4E86;&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x7814;&#x7A76;&#x4E86;&#x4E0B;MAC&#x672C;&#x5730;&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;HTTPS&#xFF0C;&#x603B;&#x7684;&#x6765;&#x8BF4;&#xFF0C;&#x6709;&#x5982;&#x4E0B;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#xFF1A;&#x4E00;&#x3001;&#x5229;&#x7528;keytool&#x5B9E;&#x73B0;&#xFF1B;&#x4E8C;&#x3001;&#x5229;&#x7528;openssl&#x5B9E;&#x73B0;&#xFF1B;&#x4E09;&#x3001;&#x5229;&#x7528;&#x8F6F;&#x4EF6;xca&#x5B9E;&#x73B0;<br>  <a id="more"></a></p>
<h2 id="Mac&#x672C;&#x5730;&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#x7684;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;"><a href="#Mac&#x672C;&#x5730;&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#x7684;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;" class="headerlink" title="Mac&#x672C;&#x5730;&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#x7684;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;"></a>Mac&#x672C;&#x5730;&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#x7684;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;</h2><h3 id="&#x5229;&#x7528;keytool&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS"><a href="#&#x5229;&#x7528;keytool&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS" class="headerlink" title="&#x5229;&#x7528;keytool&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS"></a>&#x5229;&#x7528;keytool&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS</h3><p>keytool&#x4E3A;jdk&#x73AF;&#x5883;&#x4E2D;&#x81EA;&#x5E26;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x5728;Mac&#x7EC8;&#x7AEF;&#xFF0C;&#x8F93;&#x5165;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -version</div></pre></td></tr></table></figure>
<p>&#x5373;&#x53EF;&#x67E5;&#x770B;&#x7535;&#x8111;&#x4E0A;&#x7684;jdk&#x7248;&#x672C;&#xFF0C;&#x5982;&#x679C;&#x672A;&#x5B89;&#x88C5;jdk&#xFF0C;&#x5219;&#x9700;&#x8981;&#x5230;<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="external">java&#x5B98;&#x7F51;</a>&#x4E0B;&#x8F7D;&#x5BF9;&#x5E94;&#x5E73;&#x53F0;&#x7684;jdk&#x6587;&#x4EF6;&#xFF0C;&#x672C;&#x4E91;&#x76EE;&#x524D;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7535;&#x8111;&#x7684;jdk&#x7248;&#x672C;&#x4E3A;jdk_1.8.0_112&#xFF0C;&#x5176;&#x4ED6;&#x7248;&#x672C;&#x7684;jdk&#x7684;&#x64CD;&#x4F5C;&#x65B9;&#x6CD5;&#x4E0E;&#x4EE5;&#x4E0B;&#x65B9;&#x6CD5;&#x5927;&#x4F53;&#x76F8;&#x540C;&#xFF0C;keytool&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;</p>
<p>1&#x3001;&#x5728;Mac&#x7EC8;&#x7AEF;&#xFF0C;cd&#x5230;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x8BE5;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x5C06;&#x5B58;&#x50A8;&#x521B;&#x5EFA;&#x7684;&#x8BC1;&#x4E66;&#x76F8;&#x5173;&#x7684;&#x6587;&#x4EF6;</p>
<p>2&#x3001;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;,&#x751F;&#x6210;keystore&#x6587;&#x4EF6;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">keytool -genkey -alias localhost  -keyalg RSA -keysize 2048 -keypass localhost -validity 3650 -keystore localhost.keystore -storepass localhost</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>&#x547D;&#x4EE4;</th>
<th>&#x542B;&#x4E49;</th>
</tr>
</thead>
<tbody>
<tr>
<td>-genkey</td>
<td>&#x5728;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x4E0B;&#x751F;&#x6210;&#x4E00;&#x4E2A;keystore&#x6587;&#x4EF6;</td>
</tr>
<tr>
<td>-alias</td>
<td>&#x8BE5;keystore&#x6587;&#x4EF6;&#x7684;&#x522B;&#x540D;</td>
</tr>
<tr>
<td>-keyalg</td>
<td>&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF0C;RSA&#x52A0;&#x5BC6;</td>
</tr>
<tr>
<td>-keysize</td>
<td>&#x79D8;&#x94A5;&#x7684;&#x957F;&#x5EA6;</td>
</tr>
<tr>
<td>-keypass</td>
<td>&#x522B;&#x540D;&#x7684;&#x5BC6;&#x7801;</td>
</tr>
<tr>
<td>-validity</td>
<td>&#x8BC1;&#x4E66;&#x7684;&#x6709;&#x6548;&#x671F;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x8BBE;&#x7F6E;&#x4E3A;10&#x5E74;</td>
</tr>
<tr>
<td>-keystore</td>
<td>&#x6307;&#x5B9A;&#x79D8;&#x94A5;&#x5E93;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x7531;&#x4E8E;&#x662F;&#x52A0;&#x5BC6;&#x672C;&#x5730;&#x7684;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x5C06;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x90FD;&#x8BBE;&#x7F6E;&#x4E3A;localhost</td>
</tr>
<tr>
<td>-storepass</td>
<td>&#x83B7;&#x53D6;keystore&#x4FE1;&#x606F;&#x6240;&#x9700;&#x8981;&#x7684;&#x5BC6;&#x7801;</td>
</tr>
</tbody>
</table>
<p>keytool&#x76F8;&#x5173;&#x7684;&#x547D;&#x4EE4;&#x8BE6;&#x89C1;&#x5B98;&#x7F51;: <a href="http://docs.oracle.com/javase/8/docs/technotes/tools/windows/keytool.html" target="_blank" rel="external">keytool&#x547D;&#x4EE4;</a></p>
<p>&#x5728;&#x8F93;&#x5165;&#x4E0A;&#x8FF0;&#x547D;&#x4EE4;&#x540E;&#xFF0C;&#x4F1A;&#x51FA;&#x73B0;&#x5982;&#x4E0B;&#x754C;&#x9762;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/kt1.png" alt=""></p>
<p>&#x60A8;&#x7684;&#x540D;&#x5B57;&#x4E0E;&#x59D3;&#x6C0F;&#x662F;&#x4EC0;&#x4E48;?&#x2014;&#x2014;&#x8981;&#x52A0;&#x5BC6;&#x7684;&#x57DF;&#x540D;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x586B;&#x5199;localhost</p>
<p>&#x60A8;&#x7684;&#x7EC4;&#x7EC7;&#x5355;&#x4F4D;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;?&#x3001;&#x60A8;&#x7684;&#x7EC4;&#x7EC7;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;?&#x3001;&#x60A8;&#x6240;&#x5728;&#x7684;&#x57CE;&#x5E02;&#x6216;&#x533A;&#x57DF;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;?<br>&#x60A8;&#x6240;&#x5728;&#x7684;&#x7701;/&#x5E02;/&#x81EA;&#x6CBB;&#x533A;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;?&#xFF0C;&#x4EE5;&#x4E0A;&#x56DB;&#x4E2A;&#x4FE1;&#x606F;&#xFF0C;&#x5728;&#x5411;CA&#x7533;&#x8BF7;&#x8BC1;&#x4E66;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8BF7;&#x5982;&#x5B9E;&#x586B;&#x5199;&#xFF0C;&#x672C;&#x4E91;&#x5728;&#x6B64;&#x53EA;&#x662F;&#x6D4B;&#x8BD5;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x5168;&#x90E8;&#x5199;&#x7684;&#x662F;CN</p>
<p>&#x8BE5;&#x5355;&#x4F4D;&#x7684;&#x53CC;&#x5B57;&#x6BCD;&#x56FD;&#x5BB6;/&#x5730;&#x533A;&#x4EE3;&#x7801;&#x662F;&#x4EC0;&#x4E48;?&#x2014;&#x2014;&#x54B1;&#x5728;&#x4E2D;&#x56FD;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x8FD9;&#x4E2A;&#x53EA;&#x80FD;&#x586B;&#x5199;CN</p>
<p>&#x6240;&#x6709;&#x7684;&#x4FE1;&#x606F;&#x90FD;&#x586B;&#x5199;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x8F93;&#x5165;Y&#xFF0C;keystore&#x6587;&#x4EF6;&#x5C31;&#x751F;&#x6210;&#x4E86;</p>
<p>3&#x3001;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF0C;&#x751F;&#x6210;csr&#x6587;&#x4EF6;</p>
<p>&#x8BE5;&#x751F;&#x6210;&#x7684;csr&#x6587;&#x4EF6;&#x662F;&#x7528;&#x6765;&#x5411;CA&#x673A;&#x6784;&#x63D0;&#x4EA4;&#x8BC1;&#x4E66;&#x7533;&#x8BF7;&#x65F6;&#x7528;&#x7684;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x4EC5;&#x4EC5;&#x5C55;&#x793A;&#x5982;&#x4F55;&#x751F;&#x6210;csr&#x6587;&#x4EF6;&#xFF0C;&#x6B64;csr&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x81EA;&#x7B7E;&#x540D;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x65E0;&#x7528;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">keytool -certreq -keyalg RSA -alias localhost -file localhost.csr -keystore localhost.keystore -sigalg SHA256withRSA</div></pre></td></tr></table></figure>
<p>&#x8F93;&#x5165;&#x5B8C;&#x540E;&#xFF0C;&#x56DE;&#x8F66;&#xFF0C;&#x8F93;&#x5165;keystore&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x5373;&#x53EF;&#x751F;&#x6210;csr&#x6587;&#x4EF6;</p>
<p>&#x76F8;&#x5173;&#x7684;&#x547D;&#x4EE4;&#x89E3;&#x91CA;&#x89C1;&#x4E0A;&#x6587;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x4E0D;&#x591A;&#x63CF;&#x8FF0;</p>
<p>4&#x3001;&#x5982;&#x679C;&#x662F;&#x5411;CA&#x8BF7;&#x6C42;&#x8BC1;&#x4E66;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x76F4;&#x63A5;&#x6309;&#x7167;CA&#x7684;&#x64CD;&#x4F5C;&#x6587;&#x6863;&#x8FDB;&#x884C;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x50CF;&#x672C;&#x4E91;&#x8FD9;&#x6837;&#xFF0C;&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x6253;&#x5F00;tomcate/conf&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;server.xml&#x6587;&#x4EF6;&#xFF0C;&#x52A0;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p>
<p>&#x5728;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x7528;&#x7684;tomcate&#x662F;tomcate7.0.5&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x6709;tomcate&#xFF0C;&#x8BF7;&#x5230;<a href="http://tomcat.apache.org" target="_blank" rel="external">tomcate&#x5B98;&#x7F51;</a>&#x4E0B;&#x8F7D;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;Connector SSLEnabled=&quot;true&quot; clientAuth=&quot;false&quot; keystoreFile=&quot;&#x3010;&#x4F60;&#x7684;keystore&#x6587;&#x4EF6;&#x7684;&#x8DEF;&#x5F84;&#x3011;&quot; </div><div class="line">              keystorePass=&quot;&#x3010;&#x4F60;&#x7684;keystore&#x6587;&#x4EF6;&#x7684;&#x5BC6;&#x7801;&#x3011;&quot; maxThreads=&quot;150&quot; port=&quot;8443&quot; </div><div class="line">              protocol=&quot;org.apache.coyote.http11.Http11Protocol&quot; scheme=&quot;https&quot; secure=&quot;true&quot;</div><div class="line">              SSLProtocol=&quot;TLSv1+TLSv1.1+TLSv1.2&quot;/&gt;</div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#xFF0C;cd&#x5230;tomcate/bin&#x4E0B;&#xFF0C;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./startup.sh</div></pre></td></tr></table></figure>
<p>&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5728;&#x672C;&#x5730;&#x6D4F;&#x89C8;&#x5668;&#x8F93;&#x5165;<a href="https://localhost:8443,&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5982;&#x56FE;" target="_blank" rel="external">https://localhost:8443,&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5982;&#x56FE;</a></p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/kt2.png" alt=""></p>
<p>&#x540C;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x5230;&#x8BC1;&#x4E66;&#x4FE1;&#x606F;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/kt3.png" alt=""></p>
<h3 id="&#x5229;&#x7528;openssl&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS"><a href="#&#x5229;&#x7528;openssl&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS" class="headerlink" title="&#x5229;&#x7528;openssl&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS"></a>&#x5229;&#x7528;openssl&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS</h3><p>openssl&#x4E3A;MAC&#x7CFB;&#x7EDF;&#x81EA;&#x5E26;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x8DDF;&#x4E0A;&#x8FF0;&#x7528;keytool&#x751F;&#x6210;ssl&#x8BC1;&#x4E66;&#x7C7B;&#x4F3C;&#xFF0C;&#x5176;&#x65B9;&#x6CD5;&#x4E3A;&#xFF1A;</p>
<p>1&#x3001;&#x5728;Mac&#x7EC8;&#x7AEF;&#xFF0C;cd&#x5230;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x8BE5;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x5C06;&#x5B58;&#x50A8;&#x521B;&#x5EFA;&#x7684;&#x8BC1;&#x4E66;&#x76F8;&#x5173;&#x7684;&#x6587;&#x4EF6;</p>
<p>2&#x3001;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;,&#x5229;&#x7528;RSA&#x52A0;&#x5BC6;&#xFF0C;&#x751F;&#x6210;2048&#x5B57;&#x8282;&#x7684;&#x79C1;&#x94A5;&#x6587;&#x4EF6;&#xFF0C;&#x540C;&#x7406;&#xFF0C;&#x7531;&#x4E8E;&#x662F;&#x751F;&#x6210;&#x81EA;&#x7B7E;&#x540D;HTTPS&#x8BC1;&#x4E66;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x6240;&#x6709;&#x4FE1;&#x606F;&#x90FD;&#x8BBE;&#x7F6E;&#x6210;localhost</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl genrsa -out localhost.key 2048</div></pre></td></tr></table></figure>
<p>3&#x3001;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#xFF0C;&#x751F;&#x6210;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl req -new -x509 -key localhost.key -out localhost.cer -sha256 -nodes -days 3650</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>&#x547D;&#x4EE4;</th>
<th>&#x542B;&#x4E49;</th>
</tr>
</thead>
<tbody>
<tr>
<td>req</td>
<td>&#x751F;&#x6210;&#x65B0;&#x7684;&#x8BC1;&#x4E66;</td>
</tr>
<tr>
<td>-new</td>
<td>&#x8868;&#x793A;&#x65B0;&#x8BF7;&#x6C42;</td>
</tr>
<tr>
<td>-x509</td>
<td>&#x751F;&#x6210;&#x7684;&#x8BC1;&#x4E66;&#x7684;&#x683C;&#x5F0F;&#x662F;x509&#x7684;</td>
</tr>
<tr>
<td>-key</td>
<td>&#x751F;&#x6210;&#x8BC1;&#x4E66;&#x7528;&#x5230;&#x7684;keystore&#x6587;&#x4EF6;&#xFF08;&#x7B2C;&#x4E8C;&#x6B65;&#x751F;&#x6210;&#x7684;&#xFF09;</td>
</tr>
<tr>
<td>-out</td>
<td>&#x751F;&#x6210;&#x7684;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;</td>
</tr>
<tr>
<td>-sha256 -nodes</td>
<td>&#x8BE5;&#x8BC1;&#x4E66;&#x7528;&#x7684;&#x662F;sha256&#x52A0;&#x5BC6;</td>
</tr>
<tr>
<td>-days</td>
<td>&#x8BC1;&#x4E66;&#x6709;&#x6548;&#x671F;&#xFF0C;&#x672C;&#x4E91;&#x5728;&#x6B64;&#x8BBE;&#x7F6E;&#x7684;&#x662F;10&#x5E74;</td>
</tr>
</tbody>
</table>
<p>openssl&#x76F8;&#x5173;&#x7684;&#x547D;&#x4EE4;&#x8BE6;&#x89C1;&#x5B98;&#x7F51;&#xFF1A;<a href="https://www.openssl.org/docs/manmaster/man1/" target="_blank" rel="external">openssl&#x547D;&#x4EE4;</a></p>
<p>&#x5728;&#x8F93;&#x5165;&#x5B8C;&#x4E0A;&#x8FF0;&#x547D;&#x4EE4;&#x540E;&#xFF0C;&#x4F1A;&#x51FA;&#x73B0;&#x5982;&#x4E0B;&#x754C;&#x9762;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/os1.png" alt=""></p>
<p>Country Name&#x2013;&#x8FD9;&#x4E2A;&#xFF0C;&#x56E0;&#x4E3A;&#x662F;&#x5728;&#x4E2D;&#x56FD;&#xFF0C;&#x6240;&#x4EE5;&#x56FA;&#x5B9A;&#x5199;CN&#x3001;</p>
<p>State or Province Name&#x3001;Locality Name&#x3001;Organization Name&#x3001;Organizational Unit Name&#xFF0C;&#x8FD9;&#x56DB;&#x4E2A;&#xFF0C;&#x5728;&#x5411;CA&#x7533;&#x8BF7;&#x8BC1;&#x4E66;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8BF7;&#x5982;&#x5B9E;&#x586B;&#x5199;&#xFF0C;&#x672C;&#x4E91;&#x5728;&#x6B64;&#x53EA;&#x662F;&#x6D4B;&#x8BD5;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x5168;&#x90E8;&#x5199;&#x7684;&#x662F;CN</p>
<p>Common Name&#x2014;&#x2014;&#x8981;&#x52A0;&#x5BC6;&#x7684;&#x57DF;&#x540D;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x586B;&#x5199;localhost</p>
<p>Email Address&#x2014;&#x2014;&#x672C;&#x4E91;&#x5728;&#x8FD9;&#x91CC;&#x968F;&#x4FBF;&#x5199;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x5411;CA&#x7533;&#x8BF7;&#xFF0C;&#x8BF7;&#x5982;&#x5B9E;&#x586B;&#x5199;&#x4FE1;&#x606F;</p>
<p>4&#x3001;&#x5C06;cer&#x8BC1;&#x4E66;&#x8F6C;&#x6362;&#x6210;pfx&#x683C;&#x5F0F;&#x7684;&#x8BC1;&#x4E66;&#xFF0C;&#x4F9B;tomcate&#x4F7F;&#x7528;&#xFF0C;&#x4ECE;tomcate7&#x5F00;&#x59CB;&#xFF0C;tomcate&#x652F;&#x6301;pfx&#x683C;&#x5F0F;&#x8BC1;&#x4E66;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl pkcs12 -export -out localhost.pfx -inkey localhost.key -in localhost.cer</div></pre></td></tr></table></figure>
<p>&#x56DE;&#x8F66;&#xFF0C;&#x8BBE;&#x7F6E;&#x79D8;&#x94A5;&#x540E;&#xFF0C;&#x5373;&#x751F;&#x6210;&#x4E86;pfx&#x6587;&#x4EF6;</p>
<p>&#x76F8;&#x5173;&#x7684;&#x547D;&#x4EE4;&#x89E3;&#x91CA;&#x89C1;&#x4E0A;&#x6587;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x4E0D;&#x591A;&#x63CF;&#x8FF0;</p>
<p>5&#x3001;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF0C;&#x751F;&#x6210;csr&#x6587;&#x4EF6;</p>
<p>&#x8BE5;&#x751F;&#x6210;&#x7684;csr&#x6587;&#x4EF6;&#x662F;&#x7528;&#x6765;&#x5411;CA&#x673A;&#x6784;&#x63D0;&#x4EA4;&#x8BC1;&#x4E66;&#x7533;&#x8BF7;&#x65F6;&#x7528;&#x7684;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x4EC5;&#x4EC5;&#x5C55;&#x793A;&#x5982;&#x4F55;&#x751F;&#x6210;csr&#x6587;&#x4EF6;&#xFF0C;&#x6B64;csr&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x81EA;&#x7B7E;&#x540D;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x65E0;&#x7528;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">openssl req -new -nodes  -out localhost.csr</div></pre></td></tr></table></figure>
<p>&#x76F8;&#x5173;&#x7684;&#x547D;&#x4EE4;&#x89E3;&#x91CA;&#x89C1;&#x4E0A;&#x6587;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x4E0D;&#x591A;&#x63CF;&#x8FF0;</p>
<p>6&#x3001;&#x6253;&#x5F00;tomcate/conf&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;server.xml&#x6587;&#x4EF6;&#xFF0C;&#x52A0;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;Connector SSLEnabled=&quot;true&quot; clientAuth=&quot;false&quot; keystoreFile=&quot;&#x3010;&#x4F60;&#x7684;pfx&#x6587;&#x4EF6;&#x7684;&#x8DEF;&#x5F84;&#x3011;&quot; </div><div class="line">              keystorePass=&quot;&#x3010;&#x4F60;&#x7684;pfx&#x4EF6;&#x7684;&#x5BC6;&#x7801;&#x3011;&quot; maxThreads=&quot;150&quot; port=&quot;8443&quot; </div><div class="line">              keystoreType=&quot;PKCS12&quot;</div><div class="line">              protocol=&quot;org.apache.coyote.http11.Http11Protocol&quot; scheme=&quot;https&quot; secure=&quot;true&quot;</div><div class="line"></div><div class="line">              SSLProtocol=&quot;TLSv1+TLSv1.1+TLSv1.2&quot;/&gt;</div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#xFF0C;cd&#x5230;tomcate/bin&#x4E0B;&#xFF0C;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./startup.sh</div></pre></td></tr></table></figure>
<p>&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5728;&#x672C;&#x5730;&#x6D4F;&#x89C8;&#x5668;&#x8F93;&#x5165;<a href="https://localhost:8443,&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5982;&#x56FE;" target="_blank" rel="external">https://localhost:8443,&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5982;&#x56FE;</a></p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/os2.png" alt=""></p>
<p>&#x540C;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x5230;&#x8BC1;&#x4E66;&#x4FE1;&#x606F;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/os3.png" alt=""></p>
<h3 id="&#x5229;&#x7528;&#x8F6F;&#x4EF6;xca&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS"><a href="#&#x5229;&#x7528;&#x8F6F;&#x4EF6;xca&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS" class="headerlink" title="&#x5229;&#x7528;&#x8F6F;&#x4EF6;xca&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS"></a>&#x5229;&#x7528;&#x8F6F;&#x4EF6;xca&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS</h3><p>xca&#x662F;&#x4E00;&#x6B3E;&#x80FD;&#x591F;&#x5F88;&#x65B9;&#x4FBF;&#x5730;&#x5E2E;&#x6211;&#x4EEC;&#x914D;&#x7F6E;ssl&#x8BC1;&#x4E66;&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x5982;&#x679C;&#x672C;&#x5730;&#x6CA1;&#x6709;&#x5B89;&#x88C5;xca&#xFF0C;&#x53EF;&#x4EE5;&#x53BB;&#x5176;<a href="http://xca.hohnstaedt.de/" target="_blank" rel="external">&#x5B98;&#x7F51;</a>&#x4E0B;&#x8F7D;,&#x5229;&#x7528;xca&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;HTTPS&#x7684;&#x6B65;&#x9AA4;&#x5982;&#x4E0B;:</p>
<p>1&#x3001;&#x6253;&#x5F00;&#x8F6F;&#x4EF6;&#xFF0C;&#x4F9D;&#x6B21;&#x3010;File&#x3011;-&gt;&#x3010;New DataBase&#x3011;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca1.png" alt=""></p>
<p>&#x8F93;&#x5165;xdb&#x7684;&#x6587;&#x4EF6;&#x540D;&#x3001;&#x9009;&#x62E9;xdb&#x6587;&#x4EF6;&#x7684;&#x4FDD;&#x5B58;&#x8DEF;&#x5F84;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca2.png" alt=""></p>
<p>&#x8F93;&#x5165;&#x5BC6;&#x7801;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BC6;&#x7801;&#xFF0C;&#x662F;&#x6211;&#x4EEC;&#x8BA4;&#x4E3A;&#x5730;&#x8BBE;&#x7F6E;&#x7684;&#x6B64;xdb&#x6587;&#x4EF6;&#x7684;&#x5BC6;&#x7801;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca3.png" alt=""></p>
<p>&#x5207;&#x6362;&#x5230;&#x3010;Certificates&#x3011;&#x9875;&#x9762;,&#x70B9;&#x51FB;&#x3010;New Certificate&#x3011;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca4.png" alt=""></p>
<p>&#x7531;&#x4E8E;&#x7B2C;&#x4E00;&#x6B65;&#x662F;&#x521B;&#x5EFA;&#x521B;&#x5EFA;&#x6839;&#x8BC1;&#x4E66;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x4E91;&#x5728;&#x8FD9;&#x8FD9;&#x91CC;&#x9009;&#x62E9;&#x5E8F;&#x53F7;&#x4E3A;1&#x7684;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;,&#x7B7E;&#x540D;&#x7B97;&#x6CD5;&#x9009;&#x62E9;SHA-256,&#x8BC1;&#x4E66;&#x6A21;&#x7248;&#x9009;&#x62E9;&#x9ED8;&#x8BA4;CA,&#x70B9;&#x51FB;&#x3010;Apply all&#x3011;&#xFF0C;&#x5207;&#x6362;&#x5230;&#x3010;Subject&#x3011;&#x9875;&#x9762;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca5.png" alt=""></p>
<p>&#x7531;&#x4E8E;&#x672C;&#x4E91;&#x5728;&#x6B64;&#x662F;&#x4F7F;&#x7528;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;&#xFF0C;&#x6D4B;&#x8BD5;&#x7528;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x4FE1;&#x606F;&#x90FD;&#x5199;&#x7684;&#x662F;CN&#xFF0C;&#x5982;&#x679C;&#x8981;&#x5C06;&#x6B64;&#x8BC1;&#x4E66;&#x771F;&#x6B63;&#x7528;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;webService&#xFF0C;&#x8BF7;&#x586B;&#x5199;&#x6B63;&#x786E;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;(&#x57CE;&#x5E02;&#x540D;&#x3001;&#x516C;&#x53F8;&#x540D;&#x7B49;),&#x70B9;&#x51FB;&#x3010;Generate a new key&#x3011;&#x4EA7;&#x751F;&#x79C1;&#x94A5;&#xFF0C;&#x586B;&#x5199;&#x597D;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x5373;&#x53EF;&#x751F;&#x6210;&#x6839;&#x8BC1;&#x4E66;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca6.png" alt=""></p>
<p>2&#x3001;&#x9009;&#x62E9;&#x5DF2;&#x7ECF;&#x5236;&#x4F5C;&#x597D;&#x7684;&#x6839;&#x8BC1;&#x4E66;,&#x7136;&#x540E;&#x70B9;&#x51FB;&#x3010;New Certificate&#x3011;&#xFF0C;&#x7B7E;&#x540D;&#x9009;&#x62E9;&#x521A;&#x751F;&#x6210;&#x7684;&#x6839;&#x8BC1;&#x4E66;&#x7B7E;&#x540D;&#xFF0C;&#x8BC1;&#x4E66;&#x7C7B;&#x578B;&#x9009;&#x62E9;&#x670D;&#x52A1;&#x5668;&#x8BC1;&#x4E66;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca7.png" alt=""></p>
<p>&#x70B9;&#x51FB;&#x3010;Apply all&#x3011;&#xFF0C;&#x5207;&#x6362;&#x5230;&#x3010;Subject&#x3011;&#x9875;&#x9762;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca8.png" alt=""></p>
<p>&#x540C;&#x7406;&#xFF0C;&#x5728;&#x6D4B;&#x8BD5;&#x9636;&#x6BB5;&#xFF0C;&#x672C;&#x4E91;&#x6240;&#x6709;&#x7684;&#x4FE1;&#x606F;&#x90FD;&#x5199;&#x7684;&#x662F;US&#xFF0C;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x5C06;&#x6B64;&#x8BC1;&#x4E66;&#x771F;&#x6B63;&#x7528;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;webService&#xFF0C;&#x8BF7;&#x586B;&#x5199;&#x6B63;&#x786E;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;(&#x57CE;&#x5E02;&#x540D;&#x3001;&#x516C;&#x53F8;&#x540D;&#x7B49;),&#x70B9;&#x51FB;&#x3010;Generate a new key&#x3011;&#x4EA7;&#x751F;&#x79C1;&#x94A5;&#xFF0C;&#x586B;&#x5199;&#x597D;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x5373;&#x53EF;&#x751F;&#x6210;&#x670D;&#x52A1;&#x5668;&#x8BC1;&#x4E66;</p>
<p>&#x9009;&#x62E9;&#x521A;&#x751F;&#x6210;&#x7684;&#x670D;&#x52A1;&#x5668;&#x8BC1;&#x4E66;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca9.png" alt=""></p>
<p>&#x70B9;&#x51FB;&#x3010;Export]&#xFF0C;&#x5C06;&#x8BC1;&#x4E66;&#x5BFC;&#x51FA;&#x4E3A;p12&#x683C;&#x5F0F;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca10.png" alt=""></p>
<p>&#x8F93;&#x5165;p12&#x6587;&#x4EF6;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x5373;&#x53EF;&#x751F;&#x6210;p12&#x6587;&#x4EF6;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca11.png" alt=""></p>
<p>3&#x3001;&#x6253;&#x5F00;tomcate/conf&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;server.xml&#x6587;&#x4EF6;&#xFF0C;&#x52A0;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;Connector SSLEnabled=&quot;true&quot; clientAuth=&quot;false&quot; keystoreFile=&quot;&#x3010;&#x4F60;&#x7684;pfx&#x6587;&#x4EF6;&#x7684;&#x8DEF;&#x5F84;&#x3011;&quot; </div><div class="line">              keystorePass=&quot;&#x3010;&#x4F60;&#x7684;pfx&#x4EF6;&#x7684;&#x5BC6;&#x7801;&#x3011;&quot; maxThreads=&quot;150&quot; port=&quot;8443&quot; </div><div class="line">              keystoreType=&quot;PKCS12&quot;</div><div class="line">              protocol=&quot;org.apache.coyote.http11.Http11Protocol&quot; scheme=&quot;https&quot; secure=&quot;true&quot;</div><div class="line"></div><div class="line">              SSLProtocol=&quot;TLSv1+TLSv1.1+TLSv1.2&quot;/&gt;</div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#xFF0C;cd&#x5230;tomcate/bin&#x4E0B;&#xFF0C;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./startup.sh</div></pre></td></tr></table></figure>
<p>&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5728;&#x672C;&#x5730;&#x6D4F;&#x89C8;&#x5668;&#x8F93;&#x5165;<a href="https://localhost:8443,&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5982;&#x56FE;" target="_blank" rel="external">https://localhost:8443,&#x5373;&#x53EF;&#x542F;&#x52A8;tomcate&#xFF0C;&#x5982;&#x56FE;</a></p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca12.png" alt=""></p>
<p>&#x540C;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x5230;&#x8BC1;&#x4E66;&#x4FE1;&#x606F;</p>
<p><img src="/2017/01/12/Mac&#x81EA;&#x7B7E;&#x540D;&#x5B9E;&#x73B0;&#x672C;&#x5730;HTTPS/xca13.png" alt=""></p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x672C;&#x6587;&#x8BB2;&#x8FF0;&#x4E86;&#x5982;&#x4F55;&#x5728;MAC&#x7AEF;&#x5B9E;&#x73B0;&#x81EA;&#x7B7E;&#x540D;&#x672C;&#x5730;HTTPS&#xFF0C;&#x603B;&#x5171;&#x6709;&#x4E0A;&#x8FF0;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x867D;&#x7136;&#x8BF4;&#x672C;&#x4E91;&#x7814;&#x7A76;HTTPS&#x76F8;&#x5173;&#x7684;&#x77E5;&#x8BC6;&#x7684;&#x80CC;&#x666F;&#x662F;&#x82F9;&#x679C;&#x5728;WWDC2016&#x4E0A;&#x5BA3;&#x5E03;&#x7684;&#x5230;2016&#x5E74;&#x5E95;&#xFF0C;&#x6240;&#x6709;&#x63D0;&#x4EA4;AppStore&#x5BA1;&#x6838;&#x7684;&#x5E94;&#x7528;&#x5FC5;&#x987B;&#x5F3A;&#x5236;&#x652F;&#x6301;ATS(App Transport Security)&#xFF08;&#x5DF2;&#x5EF6;&#x671F;&#xFF09;&#xFF0C;&#x4F46;&#x672C;&#x6587;&#x4EC5;&#x4EC5;&#x53EA;&#x662F;&#x63D0;&#x53CA;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x672C;&#x5730;&#x81EA;&#x7B7E;&#x540D;HTTPS&#xFF0C;&#x5173;&#x4E8E;&#x5411;CA&#x7533;&#x8BF7;&#x8BC1;&#x4E66;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x4E5F;&#x53EA;&#x662F;&#x4E00;&#x7B14;&#x5E26;&#x8FC7;&#x3002;&#x5173;&#x4E8E;ATS&#x7684;&#x5177;&#x4F53;&#x8981;&#x6C42;&#xFF0C;&#x8BE6;&#x89C1;<a href="https://developer.apple.com/library/prerelease/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW59" target="_blank" rel="external">&#x82F9;&#x679C;&#x5B98;&#x65B9;&#x5173;&#x4E8E;ATS&#x7684;&#x4ECB;&#x7ECD;</a>&#xFF0C;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x8D2D;&#x4E70;CA&#x7684;&#x8BC1;&#x4E66;&#xFF0C;&#x8BE5;&#x8BC1;&#x4E66;&#x5FC5;&#x987B;&#x7B26;&#x5408;ATS&#x8981;&#x6C42;&#xFF0C;&#x4E14;&#x8BE5;&#x8BC1;&#x4E66;&#x5185;&#x7F6E;&#x4E8E;&#x82F9;&#x679C;iOS&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x8BE6;&#x60C5;&#x8BF7;&#x89C1;<a href="https://support.apple.com/zh-cn/HT204132" target="_blank" rel="external">iOS&#x53EF;&#x4FE1;&#x4EFB;&#x8BC1;&#x4E66;&#x5217;&#x8868;</a>&#xFF0C;&#x5982;&#x679C;&#x662F;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;&#xFF0C;&#x9664;&#x4E86;&#x6309;&#x7167;&#x4E0A;&#x8FF0;&#x65B9;&#x6CD5;&#x751F;&#x6210;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x8BC1;&#x4E66;&#x5916;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x505A;&#x76F8;&#x5E94;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x4E0D;&#x7BA1;&#x7528;&#x54EA;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x90FD;&#x5FC5;&#x987B;&#x7B26;&#x5408;ATS&#x8981;&#x6C42;&#xFF0C;&#x540C;&#x65F6;&#xFF0C;&#x82F9;&#x679C;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x68C0;&#x6D4B;&#x63A5;&#x53E3;&#x662F;&#x5426;&#x7B26;&#x5408;ATS&#x8981;&#x6C42;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#xFF0C;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nscurl --ats-diagnostics &#x2013;verbose &#x3010;www.example.com&#x3011;</div></pre></td></tr></table></figure>
<p>&#x5982;&#x679C;&#x6240;&#x6709;&#x7684;&#x7ED3;&#x679C;&#x90FD;&#x662F;pass&#xFF0C;&#x5219;&#x8BE5;&#x63A5;&#x53E3;&#x901A;&#x8FC7;ATS&#x9A8C;&#x8BC1;</p>
<p>&#x53E6;&#x5916;&#xFF0C;&#x95FB;&#x9053;&#x6709;&#x5148;&#x540E;&#xFF0C;&#x672F;&#x4E1A;&#x6709;&#x4E13;&#x653B;&#xFF0C;&#x4F5C;&#x4E3A;&#x975E;&#x8FD0;&#x7EF4;&#x4EBA;&#x5458;&#xFF0C;&#x5173;&#x4E8E;HTTPS&#xFF0C;&#x672C;&#x4E91;&#x5E76;&#x672A;&#x6DF1;&#x5165;&#x7814;&#x7A76;&#xFF0C;&#x4E0A;&#x8FF0;&#x6587;&#x7AE0;&#xFF0C;&#x4EC5;&#x4EC5;&#x53EA;&#x662F;&#x672C;&#x4E91;&#x7814;&#x7A76;HTTPS&#x7684;&#x4E00;&#x70B9;&#x8BB0;&#x5F55;&#xFF0C;&#x5982;&#x6709;&#x9519;&#x8BEF;&#xFF0C;&#x6B22;&#x8FCE;&#x6307;&#x6B63;&#xFF0C;&#x4E0D;&#x80DC;&#x611F;&#x6FC0;</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;&amp;#x80CC;&amp;#x666F;&quot;&gt;&lt;a href=&quot;#&amp;#x80CC;&amp;#x666F;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x80CC;&amp;#x666F;&quot;&gt;&lt;/a&gt;&amp;#x80CC;&amp;#x666F;&lt;/h2&gt;&lt;p&gt;  &amp;#x82F9;&amp;#x679C;&amp;#x5728;2016&amp;#x5E74;&amp;#x7684;WWDC&amp;#x4E0A;&amp;#x63D0;&amp;#x51FA;&amp;#xFF0C;&amp;#x622A;&amp;#x6B62;&amp;#x5230;2016&amp;#x5E74;&amp;#x5E74;&amp;#x5E95;&amp;#xFF0C;&amp;#x6240;&amp;#x6709;&amp;#x63D0;&amp;#x4EA4;AppStore&amp;#x7684;&amp;#x5E94;&amp;#x7528;&amp;#xFF0C;&amp;#x5FC5;&amp;#x987B;&amp;#x5F3A;&amp;#x5236;&amp;#x652F;&amp;#x6301;HTTPS&amp;#xFF08;&amp;#x540E;&amp;#x6765;&amp;#x5EF6;&amp;#x671F;&amp;#x4E86;&amp;#xFF09;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#xFF0C;&amp;#x672C;&amp;#x4E91;&amp;#x7814;&amp;#x7A76;&amp;#x4E86;&amp;#x4E0B;MAC&amp;#x672C;&amp;#x5730;&amp;#x81EA;&amp;#x7B7E;&amp;#x540D;&amp;#x5B9E;&amp;#x73B0;HTTPS&amp;#xFF0C;&amp;#x603B;&amp;#x7684;&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;&amp;#x6709;&amp;#x5982;&amp;#x4E0B;&amp;#x4E09;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x5B9E;&amp;#x73B0;&amp;#x81EA;&amp;#x7B7E;&amp;#x540D;HTTPS&amp;#xFF1A;&amp;#x4E00;&amp;#x3001;&amp;#x5229;&amp;#x7528;keytool&amp;#x5B9E;&amp;#x73B0;&amp;#xFF1B;&amp;#x4E8C;&amp;#x3001;&amp;#x5229;&amp;#x7528;openssl&amp;#x5B9E;&amp;#x73B0;&amp;#xFF1B;&amp;#x4E09;&amp;#x3001;&amp;#x5229;&amp;#x7528;&amp;#x8F6F;&amp;#x4EF6;xca&amp;#x5B9E;&amp;#x73B0;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
